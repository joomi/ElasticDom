<template id="template">
    <style>

        .gradient, audio {
            border: 1px solid black;
            -webkit-box-shadow: inset 0 1px 0px rgba(255,255,255,.2);
            -moz-box-shadow: inset 0 1px 0px rgba(255,255,255,.2);
            box-shadow: inset 0 1px 0px rgba(255,255,255,.2);
            background: #494949; /* Old browsers */
            background: -webkit-linear-gradient(top, #494949 0%, #434242 31%, #393838 55%, #242323 83%, #1b1a1a 100%, #161515 100%, #0b0b0b 100%);
            background: -moz-linear-gradient(top, #494949 0%, #434242 31%, #393838 55%, #242323 83%, #1b1a1a 100%, #161515 100%, #0b0b0b 100%);
            background: -o-linear-gradient(top, #494949 0%, #434242 31%, #393838 55%, #242323 83%, #1b1a1a 100%, #161515 100%, #0b0b0b 100%);
            background: -ms-linear-gradient(top, #494949 0%, #434242 31%, #393838 55%, #242323 83%, #1b1a1a 100%, #161515 100%, #0b0b0b 100%);
            background: linear-gradient(top, #494949 0%, #434242 31%, #393838 55%, #242323 83%, #1b1a1a 100%, #161515 100%, #0b0b0b 100%); /* W3C */
            -image  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#494949', endColorstr='#0b0b0b',GradientType=0 ); /* IE6-9 */
        }

        .container {
            -webkit-transition: all .7s ease;
            -moz-transition: all .7s ease;
            -o-transition: all .7s ease;
            -ms-transition: all .7s ease;
            transition: all .7s ease;
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            -webkit-box-shadow: 0px 0px 13px rgba(0,0,0,.3),inset 0 1px 0px rgba(255,255,255,.2);
            -moz-box-shadow: 0px 0px 13px rgba(0,0,0,.3),inset 0 1px 0px rgba(255,255,255,.2);
            box-shadow: 0px 0px 13px rgba(0,0,0,.3),inset 0 1px 0px rgba(255,255,255,.2);
            margin: 15px;
            padding: 10px;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            -ms-box-sizing: border-box;
            box-sizing: border-box;
            display: inline-block;
        }

    </style>
</template>
<script>
    /*
    todo:
        add attributes - loop | auto play
        add more theming options | colors
        limit
        cors

     */
    var xhttp = new XMLHttpRequest(),
        title,
        items,
        description,
        image;




    xhttp.onreadystatechange = function() {
        if (xhttp.readyState == 4 && xhttp.status == 200) {
            parseXml(xhttp);
        } else {
            console.log("XML loading error");
            return;
        }
    };
    xhttp.open("GET", "pod-cast-channel.xml", true);
    xhttp.send();

    function parseXml(xml) {
        var xmlDoc = xml.responseXML;
        var channel = xmlDoc.getElementsByTagName("channel")[0];
        var items = channel.getElementsByTagName("item");
        console.log(items);

        //document.getElementById("demo").innerHTML =
        //        xmlDoc.getElementsByTagName("title")[0].childNodes[0].nodeValue;
    }

    
    var PodCastProto = Object.create(HTMLElement.prototype),
    doc = this.document._currentScript.ownerDocument;

    PodCastProto.createdCallback = function() {
        var shadow = this.createShadowRoot(),
        template = doc.querySelector('#template'),
        style = document.importNode(template.content, true),
        wrapper = document.createElement('div');
        if(this.getAttribute('wrapper') == "true")
            wrapper.className = 'container gradient';

        audio = document.createElement('audio');
        audio.controls = (this.getAttribute('controls'))?true:false;
        if(className = this.getAttribute('class-name')) {
            audio.className = className;
        }
        if(ogg = this.getAttribute('ogg-src')) {
            var source = document.createElement('source');
            source.type = 'audio/ogg';
            source.src = ogg;
            audio.appendChild(source);
        }
        if(mpg = this.getAttribute('mpg-src')) {
            var source = document.createElement('source');
            source.type = 'audio/mpg';
            source.src = mpg;
            audio.appendChild(source);
        }
        if(wav = this.getAttribute('wav-src')) {
            var source = document.createElement('source');
            source.type = 'audio/wav';
            source.src = wav;
            audio.appendChild(source);
        }
        wrapper.appendChild(style);
        wrapper.appendChild(audio);

        shadow.appendChild(wrapper);
    };

    var PodCastPlayer = document.registerElement('pod-cast-channel', {
        prototype: PodCastProto
    });

</script>
